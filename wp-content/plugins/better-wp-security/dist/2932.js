"use strict";(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[2932],{62932:(t,e,r)=>{r.d(e,{Z$:()=>M,Q7:()=>O,AR:()=>b,cM:()=>k,n7:()=>S,pC:()=>C,qD:()=>T,tO:()=>z,TE:()=>$,iY:()=>U,Cc:()=>I,Ng:()=>N,ZB:()=>P,d7:()=>A,KK:()=>w,Wy:()=>x,dD:()=>j,_t:()=>R,z6:()=>E,_D:()=>W,Mr:()=>L,aZ:()=>v});var n=r(66087),s=r(63282),i=r.n(s),o=r(74810),a=r(8601),c=r(77172),u=r(3075),f=r(64467);function h(t,e,r){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function l(t,e,r){return t.set(g(t,e),r),r}function d(t,e){return t.get(g(t,e))}function g(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var p=new WeakMap,m=new WeakMap;class b{constructor(t=void 0,e=void 0,r=void 0){h(this,p,{}),h(this,m,{}),(0,f.A)(this,"add",((t,e,r)=>(d(p,this)[t]||(d(p,this)[t]=[]),d(p,this)[t].push(e),r&&(d(m,this)[t]||(d(m,this)[t]=[]),d(m,this)[t].push(r)),this))),(0,f.A)(this,"hasErrors",(()=>this.getErrorCodes().length>0)),(0,f.A)(this,"getErrorCodes",(()=>Object.keys(d(p,this)))),(0,f.A)(this,"getErrorCode",(()=>this.getErrorCodes()[0])),(0,f.A)(this,"getErrorMessages",((t=void 0)=>{if(t)return d(p,this)[t];const e=[];for(const t in d(p,this))d(p,this).hasOwnProperty(t)&&e.concat(d(p,this)[t]);return e})),(0,f.A)(this,"getErrorMessage",((t=void 0)=>(t=t||this.getErrorCode(),this.getErrorMessages(t)[0]))),(0,f.A)(this,"getErrorData",((t=void 0)=>(t=t||this.getErrorCode(),d(m,this)[t]))),(0,f.A)(this,"getAllErrorMessages",(()=>{const t=[];for(const e in d(p,this))d(p,this).hasOwnProperty(e)&&t.push(...d(p,this)[e]);return t})),t&&(e&&(d(p,this)[t]=[e]),r&&(d(m,this)[t]=r))}static fromPHPObject(t){const e=new b;return l(p,e,t.errors),l(m,e,t.error_data),e}static fromApiError(t){const e=new b;if(d(p,e)[t.code]=[t.message],d(m,e)[t.code]=[t.data],t.additional_errors)for(const r of t.additional_errors)d(p,e)[r.code]=[r.message],r.data&&(d(m,e)||l(m,e,[]),d(m,e)[r.code].push(r.data));return e}}class y extends Error{constructor(t,...e){super(t.message||(0,u.__)("An unknown error occurred.","better-wp-security"),...e),Error.captureStackTrace&&Error.captureStackTrace(this,y),this.__response=t;for(const e in t)t.hasOwnProperty(e)&&Object.defineProperty(this,e,{value:t[e],configurable:!0,enumerable:!0,writable:!0})}toString(){return this.__response.toString()}getResponse(){return this.__response}}class O{constructor(t,e,r,n=[],s=[],i=[]){(0,f.A)(this,"type",void 0),(0,f.A)(this,"error",void 0),(0,f.A)(this,"data",void 0),(0,f.A)(this,"success",void 0),(0,f.A)(this,"info",void 0),(0,f.A)(this,"warning",void 0),this.type=t,this.error=e,this.data=r,this.success=n,this.info=s,this.warning=i,Object.seal(this)}isSuccess(){return this.type===O.SUCCESS}static async fromResponse(t){const e=e=>{const r=t.headers?.get(`X-Messages-${e}`);return r?JSON.parse(r):[]},r=204!==t.status&&t.json?await t.json():null,n=S(r),s=n.hasErrors()?O.ERROR:O.SUCCESS,i=e("Success"),o=e("Info"),a=e("Warning");return new O(s,n,r,i,o,a)}}Object.defineProperty(O,"SUCCESS",{value:"success",writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(O,"ERROR",{value:"error",writable:!1,enumerable:!1,configurable:!1});const _=(0,a.createContext)({getUrl(t,e){t="settings"===t?"itsec":"itsec-"+t;const r=(0,c.removeQueryArgs)(document.location.href,...Object.keys((0,c.getQueryArgs)(document.location.href)));return(0,c.addQueryArgs)(r,e?{page:t,path:e}:{page:t})}});function v(t,e){const{getUrl:r}=(0,a.useContext)(_);return r(t,e)}function E(t){if(t<=999)return t.toString();if(t<=9999){const e=(t/1e3).toFixed(1);return"0"===e.charAt(e.length-1)?e.replace(".0","k"):`${e}k`}if(t<=99999)return t.toString().substring(0,2)+"k";if(t<=999999)return t.toString().substring(0,3)+"k";if(t<=9999999){const e=(t/1e6).toFixed(1);return"0"===e.charAt(e.length-1)?e.replace(".0","m"):`${e}m`}if(t<=99999999)return t.toString().substring(0,2)+"m";if(t<=999999999)return t.toString().substring(0,3)+"m";if(t<=9999999999){const e=(t/1e9).toFixed(1);return"0"===e.charAt(e.length-1)?e.replace(".0","b"):`${e}b`}return t}function w(t){if(!(0,n.isPlainObject)(t))return!1;const e=Object.keys(t);return 2===e.length&&e.includes("errors")&&e.includes("error_data")}function A(t){if(!(0,n.isPlainObject)(t))return!1;const e=Object.keys(t);return(3===e.length||4===e.length)&&!(4===e.length&&!e.includes("additional_errors"))&&e.includes("code")&&e.includes("message")&&e.includes("data")}function S(t){return t instanceof b?t:w(t)?b.fromPHPObject(t):A(t)?b.fromApiError(t):new b}function C(t){const e={};for(const[r,n]of t)e[r]=n;return e}function k(t,e){const r=[[],[]];for(const n of t)r[e(n)?0:1].push(n);return r}function j(t){if(t instanceof Error)throw t;throw new y(t)}const M="https://secure.gravatar.com/avatar/d7a973c7dab26985da5f961be7b74480?s=96&d=mm&f=y&r=g";function P(t,e,r=!0){return(0,n.get)(t,["_links","self",0,"targetHints",e],r?void 0:[])}function N(t){return $(t,"self")}function R(t){const e=t.indexOf("/ithemes-security/");if(-1!==e)return t.substring(e)}function $(t,e){return(0,n.get)(t,["_links",e,0,"href"])}function I(t,e){if(t&&t.links)for(const r of t.links)if(r.rel===e)return r}function x(t,e){if("object"!==t.type)return t;let r;for(const s in e)e.hasOwnProperty(s)&&"hidden"===e[s]["ui:widget"]&&(r||(r=(0,n.cloneDeep)(t)),delete r.properties[s]);return r||t}function L(t){let e=[];if(!t)return e;const r=t instanceof b?t:S((0,n.pick)(t,["code","message","data"]));return"rest_invalid_param"===r.getErrorCode()&&(e=Object.values(r.getErrorData().params)),[...r.getAllErrorMessages(),...e]}function W(t){const e=new Date;if(t>e)return(0,u.__)("Online Recently","better-wp-security");const r=Math.floor((e-t)/1e3);let n=r/31536e3;return n>1?(0,u.sprintf)((0,u.__)("%s years","better-wp-security"),Math.floor(n)):(n=r/2592e3,n>1?(0,u.sprintf)((0,u.__)("%s months","better-wp-security"),Math.floor(n)):(n=r/86400,n>1?(0,u.sprintf)((0,u.__)("%s days","better-wp-security"),Math.floor(n)):(n=r/3600,n>1?(0,u.sprintf)((0,u.__)("%s hours","better-wp-security"),Math.floor(n)):(n=r/60,n>1?(0,u.sprintf)((0,u.__)("%s minutes","better-wp-security"),Math.floor(n)):(0,u.sprintf)((0,u.__)("%s seconds","better-wp-security"),Math.floor(n))))))}const D={html:{type:"string",validate:()=>!0},"relative-file-path":{type:"string",validate:t=>!t.includes("../")},"file-path":{type:"string",validate:t=>!!t.startsWith("/")&&!t.includes("../")},directory:{type:"string",validate:t=>!!t.startsWith("/")&&!t.includes("../")},email:{type:"string",validate:t=>function(t){if(!t||"string"!=typeof t)return!1;if(t.length<6)return!1;if(-1===t.indexOf("@",1))return!1;const[e,r]=t.split("@");if(!/^[a-zA-Z0-9!#$%&'*+\/=?^_`{|}~\.-]+$/.test(e))return!1;if(/\.{2,}/.test(r))return!1;if(r.trim().replace(/^\.|\.$/g,"")!==r)return!1;const n=r.split(".");if(n.length<2)return!1;for(const t of n){if(t.trim().replace(/^-|-$/g,"")!==t)return!1;if(!/^[a-z0-9-]+$/i.test(t))return!1}return t}(t)}};function T(){return T.instance||(T.instance=new(i())({strict:!1,formats:D})),T.instance}function U(){return U.instance||(U.instance=(0,o.Eg)({customFormats:D,ajvOptionsOverrides:{strict:!1}})),U.instance}function z(t){if(!t)return"";const e=t.toUpperCase().split("").map((t=>127397+t.charCodeAt()));return String.fromCodePoint(...e)}}}]);